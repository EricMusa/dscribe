

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>dscribe.descriptors package &mdash; DScribe 0.2.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="dscribe.kernels package" href="dscribe.kernels.html" />
    <link rel="prev" title="dscribe.core package" href="dscribe.core.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.2.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="dscribe.html">dscribe package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="dscribe.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="dscribe.core.html">dscribe.core package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">dscribe.descriptors package</a></li>
<li class="toctree-l4"><a class="reference internal" href="dscribe.kernels.html">dscribe.kernels package</a></li>
<li class="toctree-l4"><a class="reference internal" href="dscribe.libacsf.html">dscribe.libacsf package</a></li>
<li class="toctree-l4"><a class="reference internal" href="dscribe.libmbtr.html">dscribe.libmbtr package</a></li>
<li class="toctree-l4"><a class="reference internal" href="dscribe.utils.html">dscribe.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dscribe.html#module-dscribe">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing DScribe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DScribe</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">dscribe</a> &raquo;</li>
        
          <li><a href="dscribe.html">dscribe package</a> &raquo;</li>
        
      <li>dscribe.descriptors package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/doc/dscribe.descriptors.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dscribe-descriptors-package">
<h1>dscribe.descriptors package<a class="headerlink" href="#dscribe-descriptors-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-dscribe.descriptors.acsf">
<span id="dscribe-descriptors-acsf-module"></span><h2>dscribe.descriptors.acsf module<a class="headerlink" href="#module-dscribe.descriptors.acsf" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="dscribe.descriptors.acsf.ACSF">
<em class="property">class </em><code class="descclassname">dscribe.descriptors.acsf.</code><code class="descname">ACSF</code><span class="sig-paren">(</span><em>rcut</em>, <em>g2_params=None</em>, <em>g3_params=None</em>, <em>g4_params=None</em>, <em>g5_params=None</em>, <em>species=None</em>, <em>atomic_numbers=None</em>, <em>sparse=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/acsf.html#ACSF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.acsf.ACSF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dscribe.descriptors.descriptor.Descriptor" title="dscribe.descriptors.descriptor.Descriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">dscribe.descriptors.descriptor.Descriptor</span></code></a></p>
<p>Implementation of Atom-Centered Symmetry Functions. Currently valid for
finite systems only.</p>
<p>Notice that the species of the central atom is not encoded in the output,
only the surrounding environment is encoded. In a typical application one
can train a different model for each central species.</p>
<dl class="simple">
<dt>For reference, see:</dt><dd><p>“Atom-centered symmetry functions for constructing high-dimensional
neural network potentials”, Jörg Behler, The Journal of Chemical
Physics, 134, 074106 (2011), <a class="reference external" href="https://doi.org/10.1063/1.3553717">https://doi.org/10.1063/1.3553717</a></p>
</dd>
</dl>
<dl class="method">
<dt id="dscribe.descriptors.acsf.ACSF.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>system</em>, <em>positions=None</em>, <em>n_jobs=1</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/acsf.html#ACSF.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.acsf.ACSF.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ACSF output for the given systems and given positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>single</strong><strong> or </strong><strong>multiple class</strong> (<em>system</em>) – <cite>ase.Atoms</cite>): One or many atomic structures.</p></li>
<li><p><strong>positions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – Positions where to calculate ACSF. Can be
provided as cartesian positions or atomic indices. If no
positions are defined, the SOAP output will be created for all
atoms in the system. When calculating SOAP for multiple
systems, provide the positions as a list for each system.</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of parallel jobs to instantiate. Parallellizes
the calculation across samples. Defaults to serial calculation
with n_jobs=1.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Controls whether to print the progress of each job
into to the console.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The ACSF output for the given
systems and positions. The return type depends on the
‘sparse’-attribute. The first dimension is determined by the amount
of positions and systems and the second dimension is determined by
the get_number_of_features()-function. When multiple systems are
provided the results are ordered by the input order of systems and
their positions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray | scipy.sparse.csr_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.acsf.ACSF.create_single">
<code class="descname">create_single</code><span class="sig-paren">(</span><em>system</em>, <em>positions=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/acsf.html#ACSF.create_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.acsf.ACSF.create_single" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the descriptor for the given system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code> | <a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>) – Input system.</p></li>
<li><p><strong>positions</strong> (<em>iterable</em>) – Indices of the atoms around which the ACSF
will be returned. If no positions defined, ACSF will be created
for all atoms in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The ACSF output for the
given system and positions. The return type depends on the
‘sparse’-attribute. The first dimension is given by the number of
positions and the second dimension is determined by the
get_number_of_features()-function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray | scipy.sparse.coo_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="dscribe.descriptors.acsf.ACSF.g2_params">
<code class="descname">g2_params</code><a class="headerlink" href="#dscribe.descriptors.acsf.ACSF.g2_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="dscribe.descriptors.acsf.ACSF.g3_params">
<code class="descname">g3_params</code><a class="headerlink" href="#dscribe.descriptors.acsf.ACSF.g3_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="dscribe.descriptors.acsf.ACSF.g4_params">
<code class="descname">g4_params</code><a class="headerlink" href="#dscribe.descriptors.acsf.ACSF.g4_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="dscribe.descriptors.acsf.ACSF.g5_params">
<code class="descname">g5_params</code><a class="headerlink" href="#dscribe.descriptors.acsf.ACSF.g5_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.acsf.ACSF.get_number_of_features">
<code class="descname">get_number_of_features</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/acsf.html#ACSF.get_number_of_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.acsf.ACSF.get_number_of_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to inquire the final number of features that this descriptor
will have.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Number of features for this descriptor.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="dscribe.descriptors.acsf.ACSF.rcut">
<code class="descname">rcut</code><a class="headerlink" href="#dscribe.descriptors.acsf.ACSF.rcut" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="dscribe.descriptors.acsf.ACSF.species">
<code class="descname">species</code><a class="headerlink" href="#dscribe.descriptors.acsf.ACSF.species" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-dscribe.descriptors.coulombmatrix">
<span id="dscribe-descriptors-coulombmatrix-module"></span><h2>dscribe.descriptors.coulombmatrix module<a class="headerlink" href="#module-dscribe.descriptors.coulombmatrix" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="dscribe.descriptors.coulombmatrix.CoulombMatrix">
<em class="property">class </em><code class="descclassname">dscribe.descriptors.coulombmatrix.</code><code class="descname">CoulombMatrix</code><span class="sig-paren">(</span><em>n_atoms_max</em>, <em>permutation='sorted_l2'</em>, <em>sigma=None</em>, <em>seed=None</em>, <em>flatten=True</em>, <em>sparse=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/coulombmatrix.html#CoulombMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.coulombmatrix.CoulombMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dscribe.descriptors.matrixdescriptor.MatrixDescriptor" title="dscribe.descriptors.matrixdescriptor.MatrixDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">dscribe.descriptors.matrixdescriptor.MatrixDescriptor</span></code></a></p>
<p>Calculates the zero padded Coulomb matrix.</p>
<p>The Coulomb matrix is defined as:</p>
<blockquote>
<div><dl class="simple">
<dt>C_ij = 0.5 Zi**exponent      | i = j</dt><dd><p>= (Zi*Zj)/(Ri-Rj)       | i != j</p>
</dd>
</dl>
</div></blockquote>
<p>The matrix is padded with invisible atoms, which means that the matrix is
padded with zeros until the maximum allowed size defined by n_max_atoms is
reached.</p>
<p>To reach invariance against permutation of atoms, specify a valid option
for the permutation parameter.</p>
<dl class="simple">
<dt>For reference, see:</dt><dd><p>“Fast and Accurate Modeling of Molecular Atomization Energies with
Machine Learning”, Matthias Rupp, Alexandre Tkatchenko, Klaus-Robert
Mueller, and O.  Anatole von Lilienfeld, Phys. Rev. Lett, (2012),
<a class="reference external" href="https://doi.org/10.1103/PhysRevLett.108.058301">https://doi.org/10.1103/PhysRevLett.108.058301</a></p>
</dd>
<dt>and</dt><dd><p>“Learning Invariant Representations of Molecules for Atomization Energy
Prediction”, Gregoire Montavon et. al, Advances in Neural Information
Processing Systems 25 (NIPS 2012)</p>
</dd>
</dl>
<dl class="method">
<dt id="dscribe.descriptors.coulombmatrix.CoulombMatrix.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>system</em>, <em>n_jobs=1</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/coulombmatrix.html#CoulombMatrix.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.coulombmatrix.CoulombMatrix.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Coulomb matrix for the given systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>single</strong><strong> or </strong><strong>multiple class</strong> (<em>system</em>) – <cite>ase.Atoms</cite>): One or many atomic structures.</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of parallel jobs to instantiate. Parallellizes
the calculation across samples. Defaults to serial calculation
with n_jobs=1.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Controls whether to print the progress of each job
into to the console.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coulomb matrix for the
given systems. The return type depends on the ‘sparse’ and
‘flatten’-attributes. For flattened output a single numpy array or
sparse scipy.csr_matrix is returned. The first dimension is
determined by the amount of systems. If the output is not
flattened, a simple python list is returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray | scipy.sparse.csr_matrix | list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.coulombmatrix.CoulombMatrix.get_matrix">
<code class="descname">get_matrix</code><span class="sig-paren">(</span><em>system</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/coulombmatrix.html#CoulombMatrix.get_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.coulombmatrix.CoulombMatrix.get_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Coulomb matrix for the given system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code> | <a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>) – Input system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coulomb matrix as a 2D array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-dscribe.descriptors.descriptor">
<span id="dscribe-descriptors-descriptor-module"></span><h2>dscribe.descriptors.descriptor module<a class="headerlink" href="#module-dscribe.descriptors.descriptor" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="dscribe.descriptors.descriptor.Descriptor">
<em class="property">class </em><code class="descclassname">dscribe.descriptors.descriptor.</code><code class="descname">Descriptor</code><span class="sig-paren">(</span><em>flatten</em>, <em>sparse</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/descriptor.html#Descriptor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.descriptor.Descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>An abstract base class for all descriptors.</p>
<dl class="method">
<dt id="dscribe.descriptors.descriptor.Descriptor.check_atomic_numbers">
<code class="descname">check_atomic_numbers</code><span class="sig-paren">(</span><em>atomic_numbers</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/descriptor.html#Descriptor.check_atomic_numbers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.descriptor.Descriptor.check_atomic_numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to check that the given atomic numbers have been defined for
this descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>species</strong> (<em>iterable</em>) – Atomic numbers to check.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.7)"><strong>ValueError</strong></a> – If the atomic numbers in the given system are not</p></li>
<li><p><strong>included in the species given to this descriptor.</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.descriptor.Descriptor.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>system</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/descriptor.html#Descriptor.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.descriptor.Descriptor.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the descriptor for the given systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<em>ase.Atoms</em>) – The system for which to create the descriptor.</p></li>
<li><p><strong>args</strong> – Descriptor specific positional arguments.</p></li>
<li><p><strong>kwargs</strong> – Descriptor specific keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A descriptor for the system.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array | scipy.sparse.coo_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.descriptor.Descriptor.create_parallel">
<code class="descname">create_parallel</code><span class="sig-paren">(</span><em>inp</em>, <em>func</em>, <em>n_jobs</em>, <em>output_sizes=None</em>, <em>verbose=False</em>, <em>prefer='processes'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/descriptor.html#Descriptor.create_parallel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.descriptor.Descriptor.create_parallel" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to parallelize the descriptor creation across multiple systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – Contains a tuple of input arguments for each processed
system. These arguments are fed to the function specified by
“func”.</p></li>
<li><p><strong>func</strong> (<em>function</em>) – Function that outputs the descriptor when given
input arguments from “inp”.</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of parallel jobs to instantiate. Parallellizes
the calculation across samples. Defaults to serial calculation
with n_jobs=1.</p></li>
<li><p><strong>output_sizes</strong> (<em>list of ints</em>) – The size of the output for each job.
Makes the creation faster by preallocating the correct amount of
memory beforehand. If not specified, a dynamically created list of
outputs is used.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Controls whether to print the progress of each job
into to the console.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – <p>The parallelization method. Valid options are:</p>
<ul>
<li><p>”processes”: Parallelization based on processes. Uses the
“loky” backend in joblib to serialize the jobs and run them
in separate processes. Using separate processes has a bigger
memory and initialization overhead than threads, but may
provide better scalability if perfomance is limited by the
Global Interpreter Lock (GIL).</p></li>
<li><p>”threads”: Parallelization based on threads. Has bery low
memory and initialization overhead. Performance is limited by
the amount of pure python code that needs to run. Ideal when
most of the calculation time is used by C/C++ extensions that
release the GIL.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The descriptor output
for each given input. The return type depends on the desciptor
setup.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray | scipy.sparse.csr_matrix | list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.descriptor.Descriptor.get_number_of_features">
<code class="descname">get_number_of_features</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/descriptor.html#Descriptor.get_number_of_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.descriptor.Descriptor.get_number_of_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to inquire the final number of features that this descriptor
will have.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Number of features for this descriptor.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.descriptor.Descriptor.get_species_definition">
<code class="descname">get_species_definition</code><span class="sig-paren">(</span><em>species</em>, <em>atomic_numbers</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/descriptor.html#Descriptor.get_species_definition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.descriptor.Descriptor.get_species_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>A convenience function that is included to decide the correct source
of species information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>species</strong> (<em>iterable</em>) – Species information either as atomic numbers or
chemical symbols.</p></li>
<li><p><strong>atomic_numbers</strong> (<em>iterable</em>) – Species information as atomic numbers</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The correct variable for the species information.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.7)"><strong>ValueError</strong></a> – If both or none of the species information is defined.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.descriptor.Descriptor.get_system">
<code class="descname">get_system</code><span class="sig-paren">(</span><em>system</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/descriptor.html#Descriptor.get_system"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.descriptor.Descriptor.get_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to convert the given atomic system into a custom System-object
that is used internally. The System class inherits from ase.Atoms, but
includes built-in caching for geometric quantities that may be re-used
by the descriptors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code> | <a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>) – Input system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>The given system transformed into a corresponding</dt><dd><p>System-object.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-dscribe.descriptors.elementaldistribution">
<span id="dscribe-descriptors-elementaldistribution-module"></span><h2>dscribe.descriptors.elementaldistribution module<a class="headerlink" href="#module-dscribe.descriptors.elementaldistribution" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="dscribe.descriptors.elementaldistribution.ElementalDistribution">
<em class="property">class </em><code class="descclassname">dscribe.descriptors.elementaldistribution.</code><code class="descname">ElementalDistribution</code><span class="sig-paren">(</span><em>properties</em>, <em>flatten=True</em>, <em>sparse=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/elementaldistribution.html#ElementalDistribution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.elementaldistribution.ElementalDistribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dscribe.descriptors.descriptor.Descriptor" title="dscribe.descriptors.descriptor.Descriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">dscribe.descriptors.descriptor.Descriptor</span></code></a></p>
<p>Represents a generic distribution on any given grid for any given
properties. Can create both continuos and discrete distributions.</p>
<p>Continuous distributions require a standard deviation and the number of
sampling points. You can also specify the minimum and maximum values for
the axis. If these are not specified, a limit is selected based
automatically on the values with:</p>
<blockquote>
<div><p>min = values.min() - 3*std
max = values.max() + 3*std</p>
</div></blockquote>
<p>Discrete distributions are assumed to be integer values, and you only need
to specify the values.</p>
<dl class="method">
<dt id="dscribe.descriptors.elementaldistribution.ElementalDistribution.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>system</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/elementaldistribution.html#ElementalDistribution.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.elementaldistribution.ElementalDistribution.create" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code> | <a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>) – Input system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>The concatenated distributions of the</dt><dd><p>specified properties in a sparse array.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>scipy.sparse.lil_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.elementaldistribution.ElementalDistribution.gaussian_sum">
<code class="descname">gaussian_sum</code><span class="sig-paren">(</span><em>centers</em>, <em>weights</em>, <em>minimum</em>, <em>maximum</em>, <em>std</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/elementaldistribution.html#ElementalDistribution.gaussian_sum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.elementaldistribution.ElementalDistribution.gaussian_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a discrete version of a sum of Gaussian distributions.</p>
<p>The calculation is done through the cumulative distribution function
that is better at keeping the integral of the probability function
constant with coarser grids.</p>
<p>The values are normalized by dividing with the maximum value of a
gaussian with the given standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>centers</strong> (<em>1D np.ndarray</em>) – The means of the gaussians.</p></li>
<li><p><strong>weights</strong> (<em>1D np.ndarray</em>) – The weights for the gaussians.</p></li>
<li><p><strong>minimum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The minimum grid value</p></li>
<li><p><strong>maximum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The maximum grid value</p></li>
<li><p><strong>std</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Standard deviation of the gaussian</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of grid points</p></li>
<li><p><strong>settings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – The grid settings. A dictionary
containing the following information:</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of the gaussian sums on the given grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.elementaldistribution.ElementalDistribution.get_axis">
<code class="descname">get_axis</code><span class="sig-paren">(</span><em>property_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/elementaldistribution.html#ElementalDistribution.get_axis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.elementaldistribution.ElementalDistribution.get_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to return the used x-axis for the given property.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>property_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – The property name that was used in the</p></li>
<li><p><strong>constructor.</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array of x-axis values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.elementaldistribution.ElementalDistribution.get_element_occurrence">
<code class="descname">get_element_occurrence</code><span class="sig-paren">(</span><em>system</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/elementaldistribution.html#ElementalDistribution.get_element_occurrence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.elementaldistribution.ElementalDistribution.get_element_occurrence" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the count of each atomic element in the given system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>system</strong> (<em>ase.Atoms</em>) – The atomic system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The counts for each element in a list where the index
of atomic number x is self.atomic_number_to_index[x]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.elementaldistribution.ElementalDistribution.get_number_of_features">
<code class="descname">get_number_of_features</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/elementaldistribution.html#ElementalDistribution.get_number_of_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.elementaldistribution.ElementalDistribution.get_number_of_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to inquire the final number of features that this descriptor
will have.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Number of features for this descriptor.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-dscribe.descriptors.ewaldsummatrix">
<span id="dscribe-descriptors-ewaldsummatrix-module"></span><h2>dscribe.descriptors.ewaldsummatrix module<a class="headerlink" href="#module-dscribe.descriptors.ewaldsummatrix" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="dscribe.descriptors.ewaldsummatrix.EwaldSumMatrix">
<em class="property">class </em><code class="descclassname">dscribe.descriptors.ewaldsummatrix.</code><code class="descname">EwaldSumMatrix</code><span class="sig-paren">(</span><em>n_atoms_max</em>, <em>permutation='sorted_l2'</em>, <em>sigma=None</em>, <em>seed=None</em>, <em>flatten=True</em>, <em>sparse=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/ewaldsummatrix.html#EwaldSumMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.ewaldsummatrix.EwaldSumMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dscribe.descriptors.matrixdescriptor.MatrixDescriptor" title="dscribe.descriptors.matrixdescriptor.MatrixDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">dscribe.descriptors.matrixdescriptor.MatrixDescriptor</span></code></a></p>
<p>Calculates an Ewald sum matrix for the a given system.</p>
<p>Each entry M_ij of the Ewald sum matrix will contain the Coulomb energy
between atoms i and j calculated with the Ewald summation method. In the
Ewald method a constant neutralizing background charge has been added to
counteract the positive net charge.</p>
<p>The total electrostatic interaction energy in the system can calculated by
summing the upper diagonal part of the matrix, including the diagonal
itself.</p>
<p>A screening parameter a controls the width of the Gaussian charge
distributions in the Ewald summation, but the final matrix elements will be
independent of the value of the screening parameter a that is used, as long
as sufficient cutoff values are used.</p>
<p>This implementation provides default values for</p>
<dl class="simple">
<dt>For reference, see:</dt><dd><p>“Crystal Structure Representations for Machine Learning Models of
Formation Energies”, Felix Faber, Alexander Lindmaa, Anatole von
Lilienfeld, and Rickard Armiento, International Journal of Quantum
Chemistry, (2015),
<a class="reference external" href="https://doi.org/10.1002/qua.24917">https://doi.org/10.1002/qua.24917</a></p>
</dd>
<dt>and</dt><dd><p>“Ewald summation techniques in perspective: a survey”, Abdulnour Y.
Toukmaji, John A. Board Jr., Computer Physics Communications, (1996)
<a class="reference external" href="https://doi.org/10.1016/0010-4655(96)00016-1">https://doi.org/10.1016/0010-4655(96)00016-1</a></p>
</dd>
<dt>and</dt><dd><p>“R.A. Jackson and C.R.A. Catlow. Computer simulation studies of zeolite
structure. Mol. Simul., 1:207-224, 1988,
<a class="reference external" href="https://doi.org/10.1080/08927022.2013.840898">https://doi.org/10.1080/08927022.2013.840898</a>
“</p>
</dd>
</dl>
<dl class="method">
<dt id="dscribe.descriptors.ewaldsummatrix.EwaldSumMatrix.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>system</em>, <em>accuracy=1e-05</em>, <em>w=1</em>, <em>rcut=None</em>, <em>gcut=None</em>, <em>a=None</em>, <em>n_jobs=1</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/ewaldsummatrix.html#EwaldSumMatrix.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.ewaldsummatrix.EwaldSumMatrix.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Coulomb matrix for the given systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>single</strong><strong> or </strong><strong>multiple class</strong> (<em>system</em>) – <cite>ase.Atoms</cite>): One or many atomic structures.</p></li>
<li><p><strong>accuracy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The accuracy to which the sum is converged to.
Corresponds to the variable <span class="math notranslate nohighlight">\(A\)</span> in
<a class="reference external" href="https://doi.org/10.1080/08927022.2013.840898">https://doi.org/10.1080/08927022.2013.840898</a>. Used only if
gcut, rcut and a have not been specified. Provide either one
value or a list of values for each system.</p></li>
<li><p><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Weight parameter that represents the relative
computational expense of calculating a term in real and
reciprocal space. This has little effect on the total energy,
but may influence speed of computation in large systems. Note
that this parameter is used only when the cutoffs and a are set
to None. Provide either one value or a list of values for each
system.</p></li>
<li><p><strong>rcut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Real space cutoff radius dictating how many terms are
used in the real space sum. Provide either one value or a list
of values for each system.</p></li>
<li><p><strong>gcut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Reciprocal space cutoff radius. Provide either one
value or a list of values for each system.</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The screening parameter that controls the width of the
Gaussians. If not provided, a default value of <span class="math notranslate nohighlight">\(\alpha =
\sqrt{\pi}\left(\frac{N}{V^2}\right)^{1/6}\)</span> is used.
Corresponds to the standard deviation of the Gaussians. Provide
either one value or a list of values for each system.</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of parallel jobs to instantiate. Parallellizes
the calculation across samples. Defaults to serial calculation
with n_jobs=1.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Controls whether to print the progress of each job
into to the console.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ewald sum matrix for the
given systems. The return type depends on the ‘sparse’ and
‘flatten’-attributes. For flattened output a single numpy array or
sparse scipy.csr_matrix is returned. The first dimension is
determined by the amount of systems. If the output is not
flattened, a simple python list is returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray | scipy.sparse.csr_matrix | list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.ewaldsummatrix.EwaldSumMatrix.create_single">
<code class="descname">create_single</code><span class="sig-paren">(</span><em>system</em>, <em>accuracy=1e-05</em>, <em>w=1</em>, <em>rcut=None</em>, <em>gcut=None</em>, <em>a=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/ewaldsummatrix.html#EwaldSumMatrix.create_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.ewaldsummatrix.EwaldSumMatrix.create_single" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code> | <a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>) – Input system.</p></li>
<li><p><strong>accuracy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The accuracy to which the sum is converged to.
Corresponds to the variable <span class="math notranslate nohighlight">\(A\)</span> in
<a class="reference external" href="https://doi.org/10.1080/08927022.2013.840898">https://doi.org/10.1080/08927022.2013.840898</a>. Used only if gcut,
rcut and a have not been specified.</p></li>
<li><p><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Weight parameter that represents the relative
computational expense of calculating a term in real and
reciprocal space. This has little effect on the total energy,
but may influence speed of computation in large systems. Note
that this parameter is used only when the cutoffs and a are set
to None.</p></li>
<li><p><strong>rcut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Real space cutoff radius dictating how
many terms are used in the real space sum.</p></li>
<li><p><strong>gcut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Reciprocal space cutoff radius.</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The screening parameter that controls the width of the
Gaussians. If not provided, a default value of <span class="math notranslate nohighlight">\(\alpha =
\sqrt{\pi}\left(\frac{N}{V^2}\right)^{1/6}\)</span> is used.
Corresponds to the standard deviation of the Gaussians.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.ewaldsummatrix.EwaldSumMatrix.get_matrix">
<code class="descname">get_matrix</code><span class="sig-paren">(</span><em>system</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/ewaldsummatrix.html#EwaldSumMatrix.get_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.ewaldsummatrix.EwaldSumMatrix.get_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>The total energy matrix. Each matrix element (i, j) corresponds to the
total interaction energy in a system with atoms i and j.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code> | <a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>) – Input system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ewald matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-dscribe.descriptors.lmbtr">
<span id="dscribe-descriptors-lmbtr-module"></span><h2>dscribe.descriptors.lmbtr module<a class="headerlink" href="#module-dscribe.descriptors.lmbtr" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="dscribe.descriptors.lmbtr.LMBTR">
<em class="property">class </em><code class="descclassname">dscribe.descriptors.lmbtr.</code><code class="descname">LMBTR</code><span class="sig-paren">(</span><em>k</em>, <em>periodic</em>, <em>grid</em>, <em>virtual_positions</em>, <em>weighting=None</em>, <em>species=None</em>, <em>atomic_numbers=None</em>, <em>normalize_gaussians=True</em>, <em>flatten=True</em>, <em>sparse=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/lmbtr.html#LMBTR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.lmbtr.LMBTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dscribe.descriptors.mbtr.MBTR" title="dscribe.descriptors.mbtr.MBTR"><code class="xref py py-class docutils literal notranslate"><span class="pre">dscribe.descriptors.mbtr.MBTR</span></code></a></p>
<p>Implementation of local – per chosen atom – kind of the Many-body
tensor representation up to k=3.</p>
<p>Notice that the species of the central atom is not encoded in the output,
only the surrounding environment is encoded. In a typical application one
can train a different model for each central species.</p>
<p>This implementation provides the following geometry functions:</p>
<blockquote>
<div><p>-k=1: atomic number
-k=2: inverse distances
-k=3: cosines of angles</p>
</div></blockquote>
<p>and the following weighting functions:</p>
<blockquote>
<div><p>-k=1: unity(=no weighting)
-k=2: unity(=no weighting), exponential (<span class="math notranslate nohighlight">\(e^-(sx)\)</span>)
-k=3: unity(=no weighting), exponential (<span class="math notranslate nohighlight">\(e^-(sx)\)</span>)</p>
</div></blockquote>
<p>You can use this descriptor for finite and periodic systems. When dealing
with periodic systems, it is advisable to use a primitive cell, or if
supercells are included to use normalization e.g. by volume or by the norm
of the final vector.</p>
<p>If flatten=False, a list of dense np.ndarrays for each k in ascending order
is returned. These arrays are of dimension (n_elements x n_elements x
n_grid_points), where the elements are sorted in ascending order by their
atomic number.</p>
<p>If flatten=True, a scipy.sparse.coo_matrix is returned. This sparse matrix
is of size (1, n_features), where n_features is given by
get_number_of_features(). This vector is ordered so that the different
k-terms are ordered in ascending order, and within each k-term the
distributions at each entry (i, j, h) of the tensor are ordered in an
ascending order by (i * n_elements) + (j * n_elements) + (h * n_elements).</p>
<p>This implementation does not support the use of a non-identity correlation
matrix.</p>
<dl class="method">
<dt id="dscribe.descriptors.lmbtr.LMBTR.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>system</em>, <em>positions=None</em>, <em>scaled_positions=False</em>, <em>n_jobs=1</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/lmbtr.html#LMBTR.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.lmbtr.LMBTR.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the LMBTR output for the given systems and given positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>single</strong><strong> or </strong><strong>multiple class</strong> (<em>system</em>) – <cite>ase.Atoms</cite>): One or many atomic
structures.</p></li>
<li><p><strong>positions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – Positions where to calculate LMBTR. Can be
provided as cartesian positions or atomic indices. If no
positions are defined, the LMBTR output will be created for all
atoms in the system. When calculating LMBTR for multiple
systems, provide the positions as a list for each system.</p></li>
<li><p><strong>scaled_positions</strong> (<em>boolean</em>) – Controls whether the given positions
are given as scaled to the unit cell basis or not. Scaled
positions require that a cell is available for the system.
Provide either one value or a list of values for each system.</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of parallel jobs to instantiate. Parallellizes
the calculation across samples. Defaults to serial calculation
with n_jobs=1.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Controls whether to print the progress of each job
into to the console.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The LMBTR output for the given
systems and positions. The return type depends on the
‘sparse’-attribute. The first dimension is determined by the amount
of positions and systems and the second dimension is determined by
the get_number_of_features()-function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray | scipy.sparse.csr_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.lmbtr.LMBTR.create_single">
<code class="descname">create_single</code><span class="sig-paren">(</span><em>system</em>, <em>positions=None</em>, <em>scaled_positions=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/lmbtr.html#LMBTR.create_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.lmbtr.LMBTR.create_single" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the local many-body tensor representation for the given
system and positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code> | <a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>) – Input system.</p></li>
<li><p><strong>positions</strong> (<em>iterable</em>) – Positions or atom index of points, from
which local_mbtr is created. Can be a list of integer numbers
or a list of xyz-coordinates.</p></li>
<li><p><strong>scaled_positions</strong> (<em>boolean</em>) – Controls whether the given positions
are given as scaled to the unit cell basis or not. Scaled
positions require that a cell is available for the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>The local many-body tensor representations of given</dt><dd><p>positions, for k terms, as an array. These are ordered as given
in positions.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="dscribe.descriptors.lmbtr.LMBTR.decay_factor">
<code class="descname">decay_factor</code><em class="property"> = 4.242640687119286</em><a class="headerlink" href="#dscribe.descriptors.lmbtr.LMBTR.decay_factor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="dscribe.descriptors.lmbtr.LMBTR.species">
<code class="descname">species</code><a class="headerlink" href="#dscribe.descriptors.lmbtr.LMBTR.species" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-dscribe.descriptors.matrixdescriptor">
<span id="dscribe-descriptors-matrixdescriptor-module"></span><h2>dscribe.descriptors.matrixdescriptor module<a class="headerlink" href="#module-dscribe.descriptors.matrixdescriptor" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="dscribe.descriptors.matrixdescriptor.MatrixDescriptor">
<em class="property">class </em><code class="descclassname">dscribe.descriptors.matrixdescriptor.</code><code class="descname">MatrixDescriptor</code><span class="sig-paren">(</span><em>n_atoms_max</em>, <em>permutation='sorted_l2'</em>, <em>sigma=None</em>, <em>seed=None</em>, <em>flatten=True</em>, <em>sparse=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/matrixdescriptor.html#MatrixDescriptor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.matrixdescriptor.MatrixDescriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dscribe.descriptors.descriptor.Descriptor" title="dscribe.descriptors.descriptor.Descriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">dscribe.descriptors.descriptor.Descriptor</span></code></a></p>
<p>A common base class for two-body matrix-like descriptors.</p>
<dl class="method">
<dt id="dscribe.descriptors.matrixdescriptor.MatrixDescriptor.create_single">
<code class="descname">create_single</code><span class="sig-paren">(</span><em>system</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/matrixdescriptor.html#MatrixDescriptor.create_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.matrixdescriptor.MatrixDescriptor.create_single" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code> | <a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>) – Input system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>The zero padded matrix either as a 2D array or as</dt><dd><p>a 1D array depending on the setting self._flatten.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.matrixdescriptor.MatrixDescriptor.get_eigenspectrum">
<code class="descname">get_eigenspectrum</code><span class="sig-paren">(</span><em>matrix</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/matrixdescriptor.html#MatrixDescriptor.get_eigenspectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.matrixdescriptor.MatrixDescriptor.get_eigenspectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the eigenvalues of the matrix and returns a list of them
sorted by their descending absolute value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>matrix</strong> (<em>np.ndarray</em>) – The matrix to sort.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of eigenvalues sorted by absolute value.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.matrixdescriptor.MatrixDescriptor.get_matrix">
<code class="descname">get_matrix</code><span class="sig-paren">(</span><em>system</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/matrixdescriptor.html#MatrixDescriptor.get_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.matrixdescriptor.MatrixDescriptor.get_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to get the final matrix for this descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code> | <a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>) – Input system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The final two-dimensional matrix for this descriptor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.matrixdescriptor.MatrixDescriptor.get_number_of_features">
<code class="descname">get_number_of_features</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/matrixdescriptor.html#MatrixDescriptor.get_number_of_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.matrixdescriptor.MatrixDescriptor.get_number_of_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to inquire the final number of features that this descriptor
will have.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Number of features for this descriptor.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.matrixdescriptor.MatrixDescriptor.sort">
<code class="descname">sort</code><span class="sig-paren">(</span><em>matrix</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/matrixdescriptor.html#MatrixDescriptor.sort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.matrixdescriptor.MatrixDescriptor.sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts the given matrix by using the L2 norm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>matrix</strong> (<em>np.ndarray</em>) – The matrix to sort.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The sorted matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.matrixdescriptor.MatrixDescriptor.sort_randomly">
<code class="descname">sort_randomly</code><span class="sig-paren">(</span><em>matrix</em>, <em>sigma</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/matrixdescriptor.html#MatrixDescriptor.sort_randomly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.matrixdescriptor.MatrixDescriptor.sort_randomly" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a coulomb matrix, it adds random noise to the sorting defined by
sigma. For sorting, L2-norm is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>matrix</strong> (<em>np.ndarray</em>) – The matrix to randomly sort.</p>
</dd>
</dl>
<dl class="simple">
<dt>sigma:</dt><dd><dl class="simple">
<dt>float: Width of gaussian distributed noise determining how much the</dt><dd><p>rows and columns of the randomly sorted coulomb matrix are
scrambled.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The randomly sorted matrix.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.matrixdescriptor.MatrixDescriptor.zero_pad">
<code class="descname">zero_pad</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/matrixdescriptor.html#MatrixDescriptor.zero_pad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.matrixdescriptor.MatrixDescriptor.zero_pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Zero-pads the given matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>array</strong> (<em>np.ndarray</em>) – The array to pad</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The zero-padded array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-dscribe.descriptors.mbtr">
<span id="dscribe-descriptors-mbtr-module"></span><h2>dscribe.descriptors.mbtr module<a class="headerlink" href="#module-dscribe.descriptors.mbtr" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="dscribe.descriptors.mbtr.MBTR">
<em class="property">class </em><code class="descclassname">dscribe.descriptors.mbtr.</code><code class="descname">MBTR</code><span class="sig-paren">(</span><em>k</em>, <em>periodic</em>, <em>grid=None</em>, <em>weighting=None</em>, <em>species=None</em>, <em>atomic_numbers=None</em>, <em>normalize_by_volume=False</em>, <em>normalize_gaussians=True</em>, <em>flatten=True</em>, <em>sparse=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dscribe.descriptors.descriptor.Descriptor" title="dscribe.descriptors.descriptor.Descriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">dscribe.descriptors.descriptor.Descriptor</span></code></a></p>
<p>Implementation of the Many-body tensor representation up to k=3.</p>
<p>This implementation provides the following geometry functions:</p>
<ul class="simple">
<li><p>k=1: atomic number</p></li>
<li><p>k=2: inverse distances</p></li>
<li><p>k=3: cosines of angles</p></li>
</ul>
<p>and the following weighting functions:</p>
<ul class="simple">
<li><p>k=1: unity(=no weighting)</p></li>
<li><p>k=2: unity(=no weighting), exponential (<span class="math notranslate nohighlight">\(e^-(sx)\)</span>)</p></li>
<li><p>k=3: unity(=no weighting), exponential (<span class="math notranslate nohighlight">\(e^-(sx)\)</span>)</p></li>
</ul>
<p>You can use this descriptor for finite and periodic systems. When dealing
with periodic systems, it is advisable to use a primitive cell, or if
supercells are included to use normalization e.g. by volume or by the norm
of the final vector.</p>
<p>If flatten=False, a list of dense np.ndarrays for each k in ascending order
is returned. These arrays are of dimension (n_elements x n_elements x
n_grid_points), where the elements are sorted in ascending order by their
atomic number.</p>
<p>If flatten=True, a scipy.sparse.coo_matrix is returned. This sparse matrix
is of size (1, n_features), where n_features is given by
get_number_of_features(). This vector is ordered so that the different
k-terms are ordered in ascending order, and within each k-term the
distributions at each entry (i, j, h) of the tensor are ordered in an
ascending order by (i * n_elements) + (j * n_elements) + (h * n_elements).</p>
<p>This implementation does not support the use of a non-identity correlation
matrix.</p>
<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.K1">
<code class="descname">K1</code><span class="sig-paren">(</span><em>settings</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.K1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.K1" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the first order terms where the scalar mapping is the
number of atoms of a certain type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><em>System</em></a>) – Atomic system.</p></li>
<li><p><strong>settings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – Grid settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>K1 values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray | scipy.sparse.lil_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.K2">
<code class="descname">K2</code><span class="sig-paren">(</span><em>settings</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.K2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.K2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the second order terms where the scalar mapping is the
inverse distance between atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>settings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – The grid settings</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>flattened K2 values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.K3">
<code class="descname">K3</code><span class="sig-paren">(</span><em>settings</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.K3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.K3" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the third order terms where the scalar mapping is the
angle between 3 atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>settings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – The grid settings</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>flattened K3 values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.check_grid">
<code class="descname">check_grid</code><span class="sig-paren">(</span><em>grid</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.check_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.check_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to ensure that the given grid settings are valid.</p>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>system</em>, <em>n_jobs=1</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Return MBTR output for the given systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>single</strong><strong> or </strong><strong>multiple class</strong> (<em>system</em>) – <cite>ase.Atoms</cite>): One or many atomic structures.</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of parallel jobs to instantiate. Parallellizes
the calculation across samples. Defaults to serial calculation
with n_jobs=1.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Controls whether to print the progress of each job
into to the console.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coulomb matrix for the
given systems. The return type depends on the ‘sparse’ and
‘flatten’-attributes. For flattened output a single numpy array or
sparse scipy.csr_matrix is returned. The first dimension is
determined by the amount of systems. If the output is not
flattened, a simple python list is returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray | scipy.sparse.csr_matrix | list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.create_extended_system">
<code class="descname">create_extended_system</code><span class="sig-paren">(</span><em>primitive_system</em>, <em>term_number</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.create_extended_system"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.create_extended_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to create a periodically extended system, that is as small as
possible by rejecting atoms for which the given weighting will be below
the given threshold.</p>
<p>Modified for the local MBTR to only consider distances from the central
atom and to enable taking the virtual sites into account.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>primitive_system</strong> (<a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><em>System</em></a>) – The original primitive system to
duplicate.</p></li>
<li><p><strong>term_number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The term number of the tensor. For k=2, the max
distance is x, for k&gt;2, the distance is given by 2*x.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The new system that is extended so that each atom can at
most have a weight that is larger or equivalent to the given
threshold.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System">System</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.create_single">
<code class="descname">create_single</code><span class="sig-paren">(</span><em>system</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.create_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.create_single" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the many-body tensor representation for the given system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code> | <a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>) – Input system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The return type is
specified by the ‘flatten’ and ‘sparse’-parameters. If the output
is not flattened, a dictionary containing of MBTR outputs as numpy
arrays is created. Each output is under a “kX” key. If the output
is flattened, a single concatenated output vector is returned,
either as a sparse or a dense vector.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict | np.ndarray | scipy.sparse.coo_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.create_with_grid">
<code class="descname">create_with_grid</code><span class="sig-paren">(</span><em>grid=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.create_with_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.create_with_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to recalculate MBTR for an already seen system but with
different grid setttings. This function can be used after the scalar
values have been initialized with</p>
</dd></dl>

<dl class="attribute">
<dt id="dscribe.descriptors.mbtr.MBTR.decay_factor">
<code class="descname">decay_factor</code><em class="property"> = 4.242640687119286</em><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.decay_factor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.gaussian_sum">
<code class="descname">gaussian_sum</code><span class="sig-paren">(</span><em>centers</em>, <em>weights</em>, <em>settings</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.gaussian_sum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.gaussian_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a discrete version of a sum of Gaussian distributions.</p>
<p>The calculation is done through the cumulative distribution function
that is better at keeping the integral of the probability function
constant with coarser grids.</p>
<p>The values are normalized by dividing with the maximum value of a
gaussian with the given standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>centers</strong> (<em>1D np.ndarray</em>) – The means of the gaussians.</p></li>
<li><p><strong>weights</strong> (<em>1D np.ndarray</em>) – The weights for the gaussians.</p></li>
<li><p><strong>settings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – The grid settings</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of the gaussian sums on the given grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.get_k1_settings">
<code class="descname">get_k1_settings</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.get_k1_settings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.get_k1_settings" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the min, max, dx and sigma for K1.</p>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.get_k2_settings">
<code class="descname">get_k2_settings</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.get_k2_settings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.get_k2_settings" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the min, max, dx and sigma for K2.</p>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.get_k3_settings">
<code class="descname">get_k3_settings</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.get_k3_settings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.get_k3_settings" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the min, max, dx and sigma for K3.</p>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.get_number_of_features">
<code class="descname">get_number_of_features</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.get_number_of_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.get_number_of_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to inquire the final number of features that this descriptor
will have.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Number of features for this descriptor.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.initialize_scalars">
<code class="descname">initialize_scalars</code><span class="sig-paren">(</span><em>system</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.initialize_scalars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.initialize_scalars" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to initialize the scalar values for each k-term.</p>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.k1_geoms_and_weights">
<code class="descname">k1_geoms_and_weights</code><span class="sig-paren">(</span><em>system</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.k1_geoms_and_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.k1_geoms_and_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the atom count for each element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>system</strong> (<a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><em>System</em></a>) – The atomic system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The counts for each element in a list where the index
of atomic number x is self.atomic_number_to_index[x]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.k2_geoms_and_weights">
<code class="descname">k2_geoms_and_weights</code><span class="sig-paren">(</span><em>system</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.k2_geoms_and_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.k2_geoms_and_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the value of the geometry function and corresponding
weights for unique two-body combinations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>system</strong> (<a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><em>System</em></a>) – The atomic system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Inverse distances in the form: {(i, j): [list of angles] }.
The dictionaries are filled so that the entry for pair i and j is
in the entry where j&gt;=i.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.k3_geoms_and_weights">
<code class="descname">k3_geoms_and_weights</code><span class="sig-paren">(</span><em>system</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.k3_geoms_and_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.k3_geoms_and_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the value of the geometry function and corresponding
weights for unique three-body combinations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>system</strong> (<a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><em>System</em></a>) – The atomic system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(geoms, weights) Cosines of the angles (values between -1
and 1) in the form {(i,j,k): [list of angles] }. The weights
corresponding to the angles are stored in a similar dictionary.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="dscribe.descriptors.mbtr.MBTR.species">
<code class="descname">species</code><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.species" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.mbtr.MBTR.update">
<code class="descname">update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/mbtr.html#MBTR.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.mbtr.MBTR.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks and updates variables in mbtr class.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-dscribe.descriptors.sinematrix">
<span id="dscribe-descriptors-sinematrix-module"></span><h2>dscribe.descriptors.sinematrix module<a class="headerlink" href="#module-dscribe.descriptors.sinematrix" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="dscribe.descriptors.sinematrix.SineMatrix">
<em class="property">class </em><code class="descclassname">dscribe.descriptors.sinematrix.</code><code class="descname">SineMatrix</code><span class="sig-paren">(</span><em>n_atoms_max</em>, <em>permutation='sorted_l2'</em>, <em>sigma=None</em>, <em>seed=None</em>, <em>flatten=True</em>, <em>sparse=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/sinematrix.html#SineMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.sinematrix.SineMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dscribe.descriptors.matrixdescriptor.MatrixDescriptor" title="dscribe.descriptors.matrixdescriptor.MatrixDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">dscribe.descriptors.matrixdescriptor.MatrixDescriptor</span></code></a></p>
<p>Calculates the zero padded Sine matrix for different systems.</p>
<p>The Sine matrix is defined as:</p>
<blockquote>
<div><dl class="simple">
<dt>Cij = 0.5 Zi**exponent      | i = j</dt><dd><p>= (Zi*Zj)/phi(Ri, Rj)   | i != j</p>
</dd>
</dl>
<p>where phi(r1, r2) = | B * sum(k = x,y,z)[ek * sin^2(pi * ek * B^-1
(r2-r1))] | (B is the matrix of basis cell vectors, ek are the unit
vectors)</p>
</div></blockquote>
<p>The matrix is padded with invisible atoms, which means that the matrix is
padded with zeros until the maximum allowed size defined by n_max_atoms is
reached.</p>
<dl class="simple">
<dt>For reference, see:</dt><dd><p>“Crystal Structure Representations for Machine Learning Models of
Formation Energies”, Felix Faber, Alexander Lindmaa, Anatole von
Lilienfeld, and Rickard Armiento, International Journal of Quantum
Chemistry, (2015),
<a class="reference external" href="https://doi.org/10.1002/qua.24917">https://doi.org/10.1002/qua.24917</a></p>
</dd>
</dl>
<dl class="method">
<dt id="dscribe.descriptors.sinematrix.SineMatrix.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>system</em>, <em>n_jobs=1</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/sinematrix.html#SineMatrix.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.sinematrix.SineMatrix.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Sine matrix for the given systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>single</strong><strong> or </strong><strong>multiple class</strong> (<em>system</em>) – <cite>ase.Atoms</cite>): One or many atomic structures.</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of parallel jobs to instantiate. Parallellizes
the calculation across samples. Defaults to serial calculation
with n_jobs=1.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Controls whether to print the progress of each job
into to the console.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coulomb matrix for the
given systems. The return type depends on the ‘sparse’ and
‘flatten’-attributes. For flattened output a single numpy array or
sparse scipy.csr_matrix is returned. The first dimension is
determined by the amount of systems. If the output is not
flattened, a simple python list is returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray | scipy.sparse.csr_matrix | list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.sinematrix.SineMatrix.get_matrix">
<code class="descname">get_matrix</code><span class="sig-paren">(</span><em>system</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/sinematrix.html#SineMatrix.get_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.sinematrix.SineMatrix.get_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Sine matrix for the given system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code> | <a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>) – Input system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Sine matrix as a 2D array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-dscribe.descriptors.soap">
<span id="dscribe-descriptors-soap-module"></span><h2>dscribe.descriptors.soap module<a class="headerlink" href="#module-dscribe.descriptors.soap" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="dscribe.descriptors.soap.SOAP">
<em class="property">class </em><code class="descclassname">dscribe.descriptors.soap.</code><code class="descname">SOAP</code><span class="sig-paren">(</span><em>rcut</em>, <em>nmax</em>, <em>lmax</em>, <em>sigma=1.0</em>, <em>rbf='gto'</em>, <em>species=None</em>, <em>atomic_numbers=None</em>, <em>periodic=False</em>, <em>crossover=True</em>, <em>average=False</em>, <em>sparse=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/soap.html#SOAP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.soap.SOAP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dscribe.descriptors.descriptor.Descriptor" title="dscribe.descriptors.descriptor.Descriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">dscribe.descriptors.descriptor.Descriptor</span></code></a></p>
<p>Class for the Smooth Overlap of Atomic Orbitals (SOAP) descriptor. This
implementation uses orthogonalized spherical primitive gaussian type
orbitals as the radial basis set to reach a fast analytical solution.</p>
<p>For reference, see:</p>
<p>“On representing chemical environments, Albert P. Bartók, Risi Kondor, and
Gábor Csányi, Phys. Rev. B 87, 184115, (2013),
<a class="reference external" href="https://doi.org/10.1103/PhysRevB.87.184115">https://doi.org/10.1103/PhysRevB.87.184115</a></p>
<p>“Comparing molecules and solids across structural and alchemical space”,
Sandip De, Albert P. Bartók, Gábor Csányi and Michele Ceriotti, Phys.
Chem. Chem. Phys. 18, 13754 (2016), <a class="reference external" href="https://doi.org/10.1039/c6cp00415f">https://doi.org/10.1039/c6cp00415f</a></p>
<dl class="method">
<dt id="dscribe.descriptors.soap.SOAP.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>system</em>, <em>positions=None</em>, <em>n_jobs=1</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/soap.html#SOAP.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.soap.SOAP.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the SOAP output for the given systems and given positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>single</strong><strong> or </strong><strong>multiple class</strong> (<em>system</em>) – <cite>ase.Atoms</cite>): One or many atomic structures.</p></li>
<li><p><strong>positions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – Positions where to calculate SOAP. Can be
provided as cartesian positions or atomic indices. If no
positions are defined, the SOAP output will be created for all
atoms in the system. When calculating SOAP for multiple
systems, provide the positions as a list for each system.</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of parallel jobs to instantiate. Parallellizes
the calculation across samples. Defaults to serial calculation
with n_jobs=1.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Controls whether to print the progress of each job
into to the console.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The SOAP output for the given
systems and positions. The return type depends on the
‘sparse’-attribute. The first dimension is determined by the amount
of positions and systems and the second dimension is determined by
the get_number_of_features()-function. When multiple systems are
provided the results are ordered by the input order of systems and
their positions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray | scipy.sparse.csr_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.soap.SOAP.create_single">
<code class="descname">create_single</code><span class="sig-paren">(</span><em>system</em>, <em>positions=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/soap.html#SOAP.create_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.soap.SOAP.create_single" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the SOAP output for the given system and given positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code> | <a class="reference internal" href="dscribe.core.html#dscribe.core.system.System" title="dscribe.core.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>) – Input system.</p></li>
<li><p><strong>positions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – Cartesian positions or atomic indices. If
specified, the SOAP spectrum will be created for these points.
If no positions are defined, the SOAP output will be created
for all atoms in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The SOAP output for the
given system and positions. The return type depends on the
‘sparse’-attribute. The first dimension is given by the number of
positions and the second dimension is determined by the
get_number_of_features()-function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray | scipy.sparse.coo_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.soap.SOAP.get_flattened_index">
<code class="descname">get_flattened_index</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/soap.html#SOAP.get_flattened_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.soap.SOAP.get_flattened_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the 1D index of an element in an upper diagonal matrix that
has been flattened by iterating over the elements from left to right
and top to bottom.</p>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.soap.SOAP.get_full_space_output">
<code class="descname">get_full_space_output</code><span class="sig-paren">(</span><em>sub_output</em>, <em>sub_elements</em>, <em>full_elements_sorted</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/soap.html#SOAP.get_full_space_output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.soap.SOAP.get_full_space_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to partition the SOAP output to different locations depending
on the interacting elements. SOAPLite return the output partitioned by
the elements present in the given system. This function correctly
places those results within a bigger chemical space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sub_output</strong> (<em>np.ndarray</em>) – The output fron SOAPLite</p></li>
<li><p><strong>sub_elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – The atomic numbers present in the subspace</p></li>
<li><p><strong>full_elements_sorted</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – The atomic numbers present in the full
space, sorted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The given SOAP output mapped to the full chemical space.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.soap.SOAP.get_number_of_element_features">
<code class="descname">get_number_of_element_features</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/soap.html#SOAP.get_number_of_element_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.soap.SOAP.get_number_of_element_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to query the number of elements in the SOAP feature space for
a single element pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The number of features per element pair.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.soap.SOAP.get_number_of_features">
<code class="descname">get_number_of_features</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/soap.html#SOAP.get_number_of_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.soap.SOAP.get_number_of_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to inquire the final number of features that this descriptor
will have.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Number of features for this descriptor.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="dscribe.descriptors.soap.SOAP.get_sub_to_full_map">
<code class="descname">get_sub_to_full_map</code><span class="sig-paren">(</span><em>sub_elements</em>, <em>full_elements</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dscribe/descriptors/soap.html#SOAP.get_sub_to_full_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dscribe.descriptors.soap.SOAP.get_sub_to_full_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to map an index in the sub-space of elements to the full
element-space.</p>
</dd></dl>

<dl class="attribute">
<dt id="dscribe.descriptors.soap.SOAP.species">
<code class="descname">species</code><a class="headerlink" href="#dscribe.descriptors.soap.SOAP.species" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-dscribe.descriptors">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-dscribe.descriptors" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dscribe.kernels.html" class="btn btn-neutral float-right" title="dscribe.kernels package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dscribe.core.html" class="btn btn-neutral float-left" title="dscribe.core package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>